{"description": "Enterprise techniques used by XCSSET, ATT&CK software S0658 v1.1", "name": "XCSSET (S0658)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "11", "navigator": "4.5"}, "techniques": [{"score": 1, "techniqueID": "T1087", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1098", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1098.004", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) will create an ssh key if necessary with the ssh-keygen -t rsa -f $HOME/.ssh/id_rsa -P command. [XCSSET](https://attack.mitre.org/software/S0658) will upload a private key file to the server to remotely access the host without a password.(Citation: trendmicro xcsset xcode project 2020) "}, {"score": 1, "techniqueID": "T1560", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) will compress entire ~/Desktop folders excluding all .git folders, but only if the total data size is under 200MB.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.004", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses a shell script to execute Mach-o files and osacompile commands such as, osacompile -x -o xcode.app main.applescript.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1554", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses a malicious browser application to replace the legitimate browser in order to continuously capture credentials, monitor web traffic, and download additional modules.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.004", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses the ssh launchdaemon to elevate privileges, bypass system controls, and enable remote access to the victim.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1486", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) performs AES-CBC encryption on files under ~/Documents, ~/Downloads, and\n~/Desktop with a fixed key and renames files to give them a .enc extension. Only files with sizes \nless than 500MB are encrypted.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1573", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1573.001", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses RC4 encryption over TCP to communicate with its C2 server.(Citation: trendmicro xcsset xcode project 2020)  "}, {"score": 1, "techniqueID": "T1041", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) exfiltrates data stolen from a system over its C2 channel.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1068", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) has used a zero-day exploit in the ssh launchdaemon to elevate privileges and bypass SIP.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1222", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1222.002", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses the chmod +x command to grant executable permissions to the malicious file.(Citation: 20 macOS Common Tools and Techniques)"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.001", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses a hidden folder named .xcassets and .git to embed itself in Xcode.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1574", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1574.006", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) adds malicious file paths to the DYLD_FRAMEWORK_PATH and DYLD_LIBRARY_PATH environment variables to execute malicious code.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) downloads browser specific AppleScript modules using a constructed URL with the curl command, https://\" &amp; domain &amp; \"/agent/scripts/\" &amp; moduleName &amp; \".applescript.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1056", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1056.002", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) prompts the user to input credentials using a native macOS dialog box leveraging the system process /Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1036", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) builds a malicious application bundle to resemble Safari through using the Safari icon and Info.plist. (Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1647", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses the plutil command to modify the LSUIElement, DFBundleDisplayName, and CFBundleIdentifier keys in the /Contents/Info.plist file to change how [XCSSET](https://attack.mitre.org/software/S0658) is visible on the system.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1113", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) saves a screen capture of the victim's system with a numbered filename and .jpg extension. Screen captures are taken at specified intervals based on the system. (Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1518", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses ps aux with the grep command to enumerate common browsers and system processes potentially impacting [XCSSET](https://attack.mitre.org/software/S0658)'s exfiltration capabilities.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) searches firewall configuration files located in /Library/Preferences/ and uses csrutil status to determine if System Integrity Protection is enabled.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1539", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses scp to access the ~/Library/Cookies/Cookies.binarycookies file.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1195", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1195.001", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) adds malicious code to a host's Xcode projects by enumerating CocoaPods target_integrator.rb files under the /Library/Ruby/Gems folder or enumerates all .xcodeproj folders under a given directory. [XCSSET](https://attack.mitre.org/software/S0658) then downloads a script and Mach-O file into the Xcode project folder.(Citation: trendmicro xcsset xcode project 2020)"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) identifies the macOS version and uses ioreg to determine serial number.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1614", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1614.001", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) uses AppleScript to check the host's language and location with the command user locale of (get system info).(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1569", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1569.001", "showSubtechniques": true, "comment": "[XCSSET](https://attack.mitre.org/software/S0658) loads a system level launchdaemon using the launchctl load -w command from /System/Librarby/LaunchDaemons/ssh.plist.(Citation: trendmicro xcsset xcode project 2020)"}, {"techniqueID": "T1497", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1497.003", "showSubtechniques": true, "comment": "Using the machine's local time, [XCSSET](https://attack.mitre.org/software/S0658) waits 43200 seconds (12 hours) from the initial creation timestamp of a specific file, .report. After the elapsed time, [XCSSET](https://attack.mitre.org/software/S0658) executes additional modules.(Citation: trendmicro xcsset xcode project 2020)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by XCSSET", "color": "#66b1ff"}]}