{"description": "Enterprise techniques used by Diavol, ATT&CK software S0659 v1.0", "name": "Diavol (S0659)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "11", "navigator": "4.5"}, "techniques": [{"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has used HTTP GET and POST requests for C2.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1485", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can delete specified files from a targeted system.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1486", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has encrypted files using an RSA key though the `CryptEncrypt` API and has appended filenames with \".lock64\". (Citation: Fortinet Diavol July 2021)"}, {"techniqueID": "T1491", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1491.001", "showSubtechniques": true, "comment": " After encryption, [Diavol](https://attack.mitre.org/software/S0659) will capture the desktop background window, set the background color to black, and change the desktop wallpaper to a newly created bitmap image with the text \u201cAll your files are encrypted! For more information see \u201cREADME-FOR-DECRYPT.txt\".(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has a command to traverse the files and directories in a given path.(Citation: Fortinet Diavol July 2021) "}, {"techniqueID": "T1562", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1562.001", "showSubtechniques": true, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can attempt to stop security software.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can receive configuration updates and additional payloads including wscpy.exe from C2.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1490", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can delete shadow copies using the `IVssBackupComponents` COM object to call the `DeleteSnapshots` method.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has used several API calls like `GetLogicalDriveStrings`, `SleepEx`, `SystemParametersInfoAPI`, `CryptEncrypt`, and others to execute parts of its attack.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1135", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has a `ENMDSKS` command to enumerates available network shares.(Citation: Fortinet Diavol July 2021) "}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has Base64 encoded the RSA public key used for encrypting files.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1027.003", "showSubtechniques": true, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has obfuscated its main code routines within bitmap images as part of its anti-analysis techniques.(Citation: Fortinet Diavol July 2021) "}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) has used `CreateToolhelp32Snapshot`, `Process32First`, and `Process32Next` API calls to enumerate the running processes in the system.(Citation: Fortinet Diavol July 2021)"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.002", "showSubtechniques": true, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can spread throughout a network via SMB prior to encryption.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can use the ARP table to find remote hosts to scan.(Citation: Fortinet Diavol July 2021) "}, {"score": 1, "techniqueID": "T1489", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) will terminate services using the Service Control Manager (SCM) API.(Citation: Fortinet Diavol July 2021) "}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can collect the computer name and OS version from the system.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can enumerate victims' local and external IPs when registering with C2.(Citation: Fortinet Diavol July 2021)"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "[Diavol](https://attack.mitre.org/software/S0659) can collect the username from a compromised host.(Citation: Fortinet Diavol July 2021)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Diavol", "color": "#66b1ff"}]}