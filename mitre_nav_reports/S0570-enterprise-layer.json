{"description": "Enterprise techniques used by BitPaymer, ATT&CK software S0570 v1.0", "name": "BitPaymer (S0570)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "11", "navigator": "4.5"}, "techniques": [{"techniqueID": "T1548", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can suppress UAC prompts by setting the HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command registry key on Windows 10 or HKCU\\Software\\Classes\\mscfile\\shell\\open\\command on Windows 7 and launching the eventvwr.msc process, which launches [BitPaymer](https://attack.mitre.org/software/S0570) with elevated privileges.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1134", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1134.001", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can use the tokens of users to create processes on infected systems.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.001", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can enumerate the sessions for each user logged onto the infected host.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) has set the run key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) has attempted to install itself as a service to maintain persistence.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1486", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can import a hard-coded RSA 1024-bit public key, generate a 128-bit RC4 key for each file, and encrypt the file in place, appending .locked to the filename.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1480", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) compares file names and paths to a list of excluded names and directory names during encryption.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1222", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1222.001", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can use icacls /reset and takeown /F to reset a targeted executable's permissions and then take ownership.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.004", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) has copied itself to the :bin alternate data stream of a newly created file.(Citation: Crowdstrike Indrik November 2018)"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.006", "showSubtechniques": true, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can modify the timestamp of an executable so that it can be identified and restored by the decryption tool.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1490", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) attempts to remove the backup shadow files from the host using vssadmin.exe Delete Shadows /All /Quiet.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can set values in the Registry to help in execution.(Citation: Crowdstrike Indrik November 2018) "}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) has used dynamic API resolution to avoid identifiable strings within the binary, including RegEnumKeyW.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1135", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can search for network shares on the domain or workgroup using net view .(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) has used RC4-encrypted strings and string hashes to avoid identifiable strings within the binary.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can use the RegEnumKeyW to iterate through Registry keys.(Citation: Crowdstrike Indrik November 2018) "}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can use net view to discover remote systems.(Citation: Crowdstrike Indrik November 2018)"}, {"score": 1, "techniqueID": "T1007", "showSubtechniques": false, "comment": "[BitPaymer](https://attack.mitre.org/software/S0570) can enumerate existing Windows services on the host that are configured to run as LocalSystem.(Citation: Crowdstrike Indrik November 2018)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by BitPaymer", "color": "#66b1ff"}]}